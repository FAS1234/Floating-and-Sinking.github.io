<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Floating and Sinking æµ®å¤œæ²‰æœˆ</title>
    <style>
        /* åŸºç¡€æ ·å¼é‡ç½® */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #ffffff;
            background-color: #1a1a2e;
            overflow-x: hidden;
        }

        /* æ¢µé«˜é£æ ¼åŠ¨æ€èƒŒæ™¯ */
        body {
            background-color: #000;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(255, 215, 0, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(0, 0, 139, 0.4) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(148, 0, 211, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 60% 60%, rgba(255, 140, 0, 0.3) 0%, transparent 50%),
                linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            background-size: 300% 300%;
            animation: vanGoghShift 20s ease infinite;
            z-index: -1;
            opacity: 0.8;
            will-change: background-position;
        }

        @keyframes vanGoghShift {
            0% { background-position: 0% 50%; }
            25% { background-position: 100% 50%; }
            50% { background-position: 100% 100%; }
            75% { background-position: 0% 100%; }
            100% { background-position: 0% 50%; }
        }
        
        /* æ·»åŠ æ¢µé«˜é£æ ¼çš„çº¹ç†æ•ˆæœ */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(255, 215, 0, 0.05) 10px, rgba(255, 215, 0, 0.05) 20px),
                repeating-linear-gradient(-45deg, transparent, transparent 10px, rgba(0, 0, 139, 0.05) 10px, rgba(0, 0, 139, 0.05) 20px);
            background-size: 200px 200px;
            animation: textureMove 30s linear infinite;
            z-index: -1;
            opacity: 0.6;
            will-change: transform;
        }
        
        @keyframes textureMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(200px, 200px); }
        }

        /* å¤´éƒ¨æ ·å¼ */
        header {
            background-color: rgba(26, 26, 46, 0.9);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #667eea;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .fas-logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: #667eea;
            text-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
        }

        /* å¯¼èˆªæ æ ·å¼ */
        nav ul {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        nav ul li a {
            color: #ffffff;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
            position: relative;
        }

        nav ul li a:hover {
            color: #667eea;
        }

        nav ul li a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -5px;
            left: 0;
            background-color: #667eea;
            transition: width 0.3s ease;
        }

        nav ul li a:hover::after {
            width: 100%;
        }

        /* ç®¡ç†å‘˜ç™»å½•æŒ‰é’®æ ·å¼ */
        .admin-login-btn {
            padding: 0.5rem 1rem;
            background-color: #667eea;
            color: white;
            border: none;
            border-radius: 30px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.3);
        }

        .admin-login-btn:hover {
            background-color: #5a67d8;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.5);
        }

        /* å®¹å™¨æ ·å¼ */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* è‹±é›„åŒºåŸŸæ ·å¼ */
        .hero-section {
            text-align: center;
            padding: 3rem 1rem;
            margin: 2rem 0;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 2rem;
        }

        .hero-text {
            position: relative;
            display: inline-block;
        }

        .main-title {
            font-size: 4rem;
            font-weight: bold;
            color: #ffffff;
            margin: 0;
            text-shadow: 0 0 20px rgba(102, 126, 234, 0.5), 0 0 40px rgba(102, 126, 234, 0.3);
            line-height: 1;
        }

        .subtitle {
            position: absolute;
            right: 2rem;
            bottom: -3.5rem;
            font-size: 1.2rem;
            color: #667eea;
            font-weight: 500;
        }

        .join-btn {
            display: inline-block;
            padding: 1rem 3rem;
            background-color: #667eea;
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .join-btn:hover {
            background-color: #5a67d8;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
        }

        .join-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.3);
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .main-title {
                font-size: 2.5rem;
            }

            .subtitle {
                right: 1rem;
                bottom: -0.8rem;
                font-size: 1rem;
            }

            .join-btn {
                padding: 0.8rem 2rem;
                font-size: 1rem;
            }
        }

        @media (max-width: 480px) {
            .main-title {
                font-size: 2rem;
            }

            .subtitle {
                right: 0.5rem;
                bottom: -0.6rem;
                font-size: 0.9rem;
            }

            .hero-section {
                padding: 2rem 1rem;
            }
        }

        /* å…¬å‘ŠåŒºåŸŸæ ·å¼ */
        .announcements {
            background-color: rgba(26, 26, 46, 0.8);
            border-radius: 10px;
            padding: 2rem;
            margin-bottom: 2rem;
            border-left: 5px solid #667eea;
        }

        .announcements h2 {
            color: #667eea;
            margin-bottom: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .announcement-item {
            background-color: rgba(102, 126, 234, 0.1);
            padding: 1rem;
            border-radius: 5px;
            margin-bottom: 1rem;
            transition: transform 0.3s ease;
        }

        .announcement-item:hover {
            transform: translateX(5px);
        }

        .announcement-item:last-child {
            margin-bottom: 1rem;
        }

        .view-more-announcements {
            width: 100%;
            padding: 1rem;
            background-color: #667eea;
            color: white;
            border: none;
            border-radius: 30px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1rem;
        }

        .view-more-announcements:hover {
            background-color: #5a67d8;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
        }

        .announcement-title {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 0.5rem;
        }

        .announcement-date {
            font-size: 0.8rem;
            color: #999;
            margin-bottom: 0.5rem;
        }

        /* è‹±é›„åŒºåŸŸæ ·å¼ */
        .hero-section {
            text-align: center;
            padding: 3rem 1rem;
            margin: 2rem 0;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 2rem;
        }

        .hero-text {
            position: relative;
            display: inline-block;
        }

        .main-title {
            font-size: 4rem;
            font-weight: bold;
            color: #ffffff;
            margin: 0;
            text-shadow: 0 0 20px rgba(102, 126, 234, 0.5), 0 0 40px rgba(102, 126, 234, 0.3);
            line-height: 1;
        }

        .subtitle {
            position: absolute;
            right: 2rem;
            bottom: -1rem;
            font-size: 1.2rem;
            color: #667eea;
            font-weight: 500;
        }

        .join-btn {
            display: inline-block;
            padding: 1rem 3rem;
            background-color: #667eea;
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .join-btn:hover {
            background-color: #5a67d8;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
        }

        .join-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.3);
        }

        /* é€šç”¨åŒºå—æ ·å¼ */
        .section {
            background-color: rgba(26, 26, 46, 0.8);
            border-radius: 10px;
            padding: 2rem;
            margin-bottom: 2rem;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .section:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.2);
        }

        .section h2 {
            color: #667eea;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        /* æˆå‘˜å±•ç¤ºæ ·å¼ */
        .members-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .member-card {
            background-color: rgba(102, 126, 234, 0.1);
            border-radius: 10px;
            padding: 1.5rem;
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid transparent;
        }

        .member-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
            border-color: #667eea;
        }

        .member-title {
            font-size: 0.9rem;
            color: #667eea;
            margin-bottom: 0.5rem;
        }

        .member-name {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .member-role {
            font-size: 0.9rem;
            color: #999;
            margin-bottom: 1rem;
        }

        .member-desc {
            font-size: 0.9rem;
            color: #ccc;
            line-height: 1.4;
        }

        /* è§’è‰²æ ‡è¯†æ ·å¼ */
        .role-indicator {
            display: inline-block;
            padding: 0.2rem 0.5rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .role-leader {
            background: linear-gradient(45deg, #ff4757, #ff6b81);
            background-size: 200% 200%;
            color: #fff;
            animation: gradientShift 3s ease infinite;
            will-change: background-position;
        }

        .role-deputy {
            background: linear-gradient(45deg, #007bff, #00d4ff);
            background-size: 200% 200%;
            color: #fff;
            animation: gradientShift 3s ease infinite;
            will-change: background-position;
        }

        @keyframes gradientShift {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }

        .role-elite {
            background: linear-gradient(45deg, #ffa726, #ffd54f);
            background-size: 200% 200%;
            color: #000;
            animation: gradientShift 3s ease infinite;
            will-change: background-position;
        }

        .role-coach {
            background: linear-gradient(45deg, #9400d3, #da70d6);
            background-size: 200% 200%;
            color: #fff;
            animation: gradientShift 3s ease infinite;
            will-change: background-position;
        }

        .role-admin {
            background: linear-gradient(45deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #9400d3);
            background-size: 1400% 1400%;
            color: #fff;
            animation: rainbowShift 4s ease infinite;
            will-change: background-position;
        }

        @keyframes rainbowShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* å°Šé‡ç”¨æˆ·åŠ¨ç”»åå¥½è®¾ç½® */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }

        /* åŠ å…¥æˆ‘ä»¬è¡¨å•æ ·å¼ */
        .join-form {
            background-color: rgba(102, 126, 234, 0.1);
            padding: 1.5rem;
            border-radius: 10px;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #667eea;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #667eea;
            border-radius: 5px;
            background-color: rgba(26, 26, 46, 0.8);
            color: #ffffff;
            font-size: 1rem;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        /* æŒ‰é’®æ ·å¼ */
        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: #ffffff;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 5px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .btn.cancel {
            background: linear-gradient(45deg, #6c757d, #495057);
        }
        
        .btn.delete {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        /* æŒ‰é’®ä¼ªå…ƒç´  */
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }



        /* åº•éƒ¨æ ·å¼ */
        footer {
            background-color: rgba(26, 26, 46, 0.9);
            backdrop-filter: blur(10px);
            padding: 2rem;
            text-align: center;
            border-top: 2px solid #667eea;
            margin-top: 2rem;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 1rem;
                padding: 1rem;
            }

            nav ul {
                gap: 1rem;
            }

            .container {
                padding: 1rem;
            }

            .members-grid {
                grid-template-columns: 1fr;
            }

            .join-contact {
                grid-template-columns: 1fr;
            }
        }

        /* å¾®åŠ¨ç”»å’Œäº¤äº’æ•ˆæœä¼˜åŒ– */
        .section {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        /* æ¨¡æ€æ¡†æ ·å¼ */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: rgba(26, 26, 46, 0.95);
            margin: 5% auto;
            padding: 2rem;
            border: 1px solid #667eea;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            position: relative;
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from { opacity: 0; transform: translateY(-50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close:hover, .close:focus {
            color: #fff;
        }

        /* æˆå‘˜ç®¡ç†æ§åˆ¶æŒ‰é’® */
        .member-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .member-controls .btn:not(:first-child) {
            margin-left: 0.5rem;
        }

        .member-action-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: #fff;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 30px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            margin-right: 0.5rem;
        }

        .member-action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .member-action-btn.delete {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
        }
    </style>
</head>
<body>
    <!-- å¤´éƒ¨ -->
    <header>
        <div class="fas-logo">Floating and Sinking</div>
        <div style="display: flex; align-items: center; gap: 1rem;">
            <nav>
                <ul>
                    <li><a href="#home">é¦–é¡µ</a></li>
                    <li><a href="#announcements">å…¬å‘Š</a></li>
                    <li><a href="#members">æˆå‘˜</a></li>
                    <li><a href="#about">å…³äº</a></li>
                </ul>
            </nav>
            <button id="adminManageBtn" class="admin-login-btn" style="display: none;">è´¦å·ç®¡ç†</button>
            <button id="adminLoginBtn" class="admin-login-btn">ç®¡ç†å‘˜ç™»å½•</button>
        </div>
    </header>

    <!-- ä¸»è¦å†…å®¹ -->
    <main class="container">
        <!-- æ–°æ·»åŠ çš„Floating and Sinkingæ¨¡å— -->
        <section class="hero-section" id="home">
            <div class="hero-text">
                <h1 class="main-title">Floating and Sinking</h1>
                <span class="subtitle">æµ®å¤œæ²‰æœˆ</span>
            </div>
            <a href="https://qm.qq.com/q/1KL3yBYVic" class="join-btn" target="_blank">åŠ å…¥QQç¾¤</a>
        </section>

        <!-- å…¬å‘ŠåŒºåŸŸ -->
        <section class="announcements" id="announcements">
            <h2>æœ€æ–°å…¬å‘Š <button class="btn admin-only" id="addAnnouncementBtn">å‘å¸ƒå…¬å‘Š</button></h2>
            <div id="announcementsList"></div>
        </section>

        <!-- å…¬ä¼šä¸»è¦æˆå‘˜ -->
        <section class="section" id="members">
            <div class="member-controls">
                <h2>å…¬ä¼šä¸»è¦æˆå‘˜</h2>
                <button class="btn" id="charactersBtn">å…¬ä¼šæˆå‘˜</button>
                <button class="btn admin-only" id="addMemberBtn">æ·»åŠ æˆå‘˜</button>
            </div>
            <div id="membersGrid" class="members-grid"></div>
        </section>

        <!-- å…¬ä¼šä»‹ç» -->
        <section class="section" id="about">
            <h2>å…³äºæµ®å¤œæ²‰æœˆ</h2>
            <p>FASçš„å…¨ç§°æ˜¯Floating and Sinkingï¼Œæ„ä¸ºæµ®å¤œæ²‰æœˆã€‚æˆ‘ä»¬æ˜¯ä¸€ä¸ªä¸“æ³¨äºMinecraft PVPçš„å…¬ä¼šï¼Œè‡´åŠ›äºæ‰“é€ ä¸€ä¸ªå……æ»¡å‡èšåŠ›çš„å¤§å®¶åº­ã€‚</p>
            <p>å¸Œæœ›å…¬ä¼šæˆå‘˜èƒ½äº’å¸®äº’åŠ©ï¼Œä¸€èµ·åŠªåŠ›å‘å±•æˆä¸€ä¸ªå¤§å®¶åº­ã€‚</p>
            <p>MINECRAFT PVP EVERYTHING IS POSSIBLE.</p>
            <p>ä¸ºäººæ°‘æœåŠ¡ï¼</p>
            <p>ä¸ºäººæ°‘æœåŠ¡ï¼</p>
            <p>ä¸ºäººæ°‘æœåŠ¡ï¼</p>
        </section>
    </main>

    <!-- åº•éƒ¨ -->
    <footer>
        <p>&copy; 2023 æµ®å¤œæ²‰æœˆ. ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚</p>
    </footer>

    <!-- ç®¡ç†å‘˜ç™»å½•æ¨¡æ€æ¡† -->
    <div id="adminLoginModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>ç®¡ç†å‘˜ç™»å½•</h2>
            <form id="adminLoginForm">
                <div class="form-group">
                    <label for="username">è´¦å·:</label>
                    <input type="text" id="username" name="username" required>
                </div>
                <div class="form-group">
                    <label for="password">å¯†ç :</label>
                    <div style="position: relative;">
                        <input type="password" id="password" name="password" required>
                        <button type="button" id="togglePassword" style="position: absolute; right: 5px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; color: #666;">
                            ğŸ‘ï¸
                        </button>
                    </div>
                </div>
                <button type="submit" class="btn confirm">ç™»å½•</button>
            </form>
        </div>
    </div>

    <!-- ç™»å½•æ¶ˆæ¯æ¨¡æ€æ¡† -->
    <div id="loginMessageModal" class="modal">
        <div class="modal-content">
            <h2 id="loginMessageTitle">ç™»å½•æ¶ˆæ¯</h2>
            <div id="loginMessage"></div>
            <button id="closeLoginMessageModal" class="btn confirm">ç¡®å®š</button>
        </div>
    </div>

    <!-- æˆå‘˜ç¼–è¾‘æ¨¡æ€æ¡† -->
    <div id="memberModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeMemberModal">&times;</span>
            <h2 id="modalTitle">æ·»åŠ æˆå‘˜</h2>
            <form id="memberForm">
                <div class="form-group">
                    <label for="memberName">æˆå‘˜åç§°</label>
                    <input type="text" id="memberName" name="memberName" required>
                </div>
                <div class="form-group">
                    <label for="memberTitle">ç§°å·</label>
                    <input type="text" id="memberTitle" name="memberTitle" required>
                </div>
                <div class="form-group">
                    <label for="memberRole">è§’è‰²</label>
                    <select id="memberRole" name="memberRole" required>
                        <option value="ä¼šé•¿">ä¼šé•¿</option>
                        <option value="å‰¯ä¼šé•¿">å‰¯ä¼šé•¿</option>
                        <option value="ç²¾è‹±é˜Ÿå‘˜">ç²¾è‹±é˜Ÿå‘˜</option>
                        <option value="æ•™ç»ƒ">æ•™ç»ƒ</option>
                        <option value="ç®¡ç†å‘˜">ç®¡ç†å‘˜</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="memberDesc">æè¿°</label>
                    <textarea id="memberDesc" name="memberDesc" required></textarea>
                </div>
                <button type="submit" class="btn">ä¿å­˜</button>
            </form>
        </div>
    </div>

    <!-- å…¬å‘Šç¼–è¾‘æ¨¡æ€æ¡† -->
    <div id="announcementModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeAnnouncementModal">&times;</span>
            <h2 id="announcementModalTitle">å‘å¸ƒå…¬å‘Š</h2>
            <form id="announcementForm">
                <div class="form-group">
                    <label for="announcementTitle">æ ‡é¢˜</label>
                    <input type="text" id="announcementTitle" name="announcementTitle" required>
                </div>
                <div class="form-group">
                    <label for="announcementContent">å†…å®¹</label>
                    <textarea id="announcementContent" name="announcementContent" rows="5" required></textarea>
                </div>
                <div style="text-align: right; margin-top: 1rem;">
                    <button type="button" class="btn cancel" onclick="closeAnnouncementModalFunc()">å–æ¶ˆ</button>
                    <button type="submit" class="btn">ä¿å­˜</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ç¡®è®¤å¯¹è¯æ¡†æ¨¡æ€æ¡† -->
        <div id="confirmModal" class="modal">
            <div class="modal-content">
                <h2 id="confirmTitle">ç¡®è®¤æ“ä½œ</h2>
                <p id="confirmMessage"></p>
                <div style="text-align: right; margin-top: 2rem;">
                    <button type="button" class="btn cancel" id="confirmCancelBtn">å–æ¶ˆ</button>
                    <button type="button" class="btn delete" id="confirmDeleteBtn">ç¡®å®šåˆ é™¤</button>
                </div>
            </div>
        </div>

        <!-- åˆ é™¤æˆåŠŸæç¤ºæ¨¡æ€æ¡† -->
        <div id="successModal" class="modal">
            <div class="modal-content">
                <h2>æ“ä½œæˆåŠŸ <span class="close" id="closeSuccessModal">&times;</span></h2>
                <p id="successMessage"></p>
                <div style="text-align: right; margin-top: 2rem;">
                    <button type="button" class="btn" id="successOkBtn">ç¡®å®š</button>
                </div>
            </div>
        </div>

    <script>
        // æˆå‘˜æ•°æ®
        let members = [
            {
                id: 1,
                name: 'Steve',
                title: 'PVPä¹‹ç¥',
                role: 'ä¼šé•¿',
                desc: 'å…¬ä¼šåˆ›å§‹äººï¼ŒPVPå¤§ç¥ï¼Œæˆ˜æœ¯å¤§å¸ˆ'
            },
            {
                id: 2,
                name: 'Alex',
                title: 'æˆ˜æœ¯ä¹‹ç‹',
                role: 'å‰¯ä¼šé•¿',
                desc: 'å›¢é˜ŸæŒ‡æŒ¥ä¸“å®¶ï¼Œæ“…é•¿åˆ¶å®šæˆ˜æœ¯'
            },
            {
                id: 3,
                name: 'Herobrine',
                title: 'ç§’æ€ä¸“å®¶',
                role: 'ç²¾è‹±é˜Ÿå‘˜',
                desc: 'æ“…é•¿å•æŒ‘æˆ˜æœ¯ï¼Œä¸€å‡»è‡´å‘½'
            },
            {
                id: 4,
                name: 'Notch',
                title: 'å»ºç­‘å¤§å¸ˆ',
                role: 'ç²¾è‹±é˜Ÿå‘˜',
                desc: 'å»ºç­‘ä¸PVPåŒä¿®ï¼Œå…¨èƒ½å‹é€‰æ‰‹'
            },
            {
                id: 5,
                name: 'Jeb',
                title: 'å‰èŒä¸šé€‰æ‰‹',
                role: 'æ•™ç»ƒ',
                desc: 'ç»éªŒä¸°å¯Œçš„å‰èŒä¸šé€‰æ‰‹ï¼ŒæŒ‡å¯¼è®­ç»ƒ'
            },
            {
                id: 6,
                name: 'Null',
                title: 'æŠ€æœ¯æ”¯æŒ',
                role: 'ç®¡ç†å‘˜',
                desc: 'æœåŠ¡å™¨ç»´æŠ¤ï¼ŒæŠ€æœ¯æ”¯æŒ'
            },
            {
                id: 7,
                name: 'æµ®å¤œæ²‰æœˆ',
                title: 'å…¬ä¼šæ ¸å¿ƒ',
                role: 'ç²¾è‹±é˜Ÿå‘˜',
                desc: 'å…¬ä¼šçš„çµé­‚äººç‰©ï¼Œå®åŠ›å¼ºå¤§'
            }
        ];

        let nextId = members.length + 1;

        // è·å–DOMå…ƒç´ 
        const membersGrid = document.getElementById('membersGrid');
        const addMemberBtn = document.getElementById('addMemberBtn');
        const memberModal = document.getElementById('memberModal');
        const closeMemberModal = document.getElementById('closeMemberModal');
        const memberForm = document.getElementById('memberForm');
        const modalTitle = document.getElementById('modalTitle');
        const memberName = document.getElementById('memberName');
        const memberTitle = document.getElementById('memberTitle');
        const memberRole = document.getElementById('memberRole');
        const memberDesc = document.getElementById('memberDesc');

        // å½“å‰ç¼–è¾‘çš„æˆå‘˜ID
        let currentMemberId = null;

        // æ¸²æŸ“æˆå‘˜åˆ—è¡¨
        function renderMembers() {
            membersGrid.innerHTML = '';
            members.forEach(member => {
                const memberCard = document.createElement('div');
                memberCard.className = 'member-card';
                
                // æ ¹æ®è§’è‰²è®¾ç½®ä¸åŒçš„æ ·å¼ç±»
                let roleClass = '';
                switch(member.role) {
                    case 'ä¼šé•¿':
                        roleClass = 'role-leader';
                        break;
                    case 'å‰¯ä¼šé•¿':
                        roleClass = 'role-deputy';
                        break;
                    case 'ç²¾è‹±é˜Ÿå‘˜':
                        roleClass = 'role-elite';
                        break;
                    case 'æ•™ç»ƒ':
                        roleClass = 'role-coach';
                        break;
                    case 'ç®¡ç†å‘˜':
                        roleClass = 'role-admin';
                        break;
                }

                // æ ¹æ®ç®¡ç†å‘˜ç™»å½•çŠ¶æ€ç”Ÿæˆæ“ä½œæŒ‰é’®
                const actionButtons = isAdminLoggedIn ? `
                    <div style="margin-top: 1rem;">
                        <button class="member-action-btn admin-only" onclick="editMember(${member.id})">ç¼–è¾‘</button>
                        <button class="member-action-btn delete admin-only" onclick="deleteMember(${member.id})">åˆ é™¤</button>
                    </div>
                ` : '';
                
                memberCard.innerHTML = `
                    <div class="member-title">${member.title}</div>
                    <div class="member-name">${member.name}</div>
                    <div class="role-indicator ${roleClass}">${member.role}</div>
                    <div class="member-desc">${member.desc}</div>
                    ${actionButtons}
                `;
                
                membersGrid.appendChild(memberCard);
            });
        }

        // æ‰“å¼€æ¨¡æ€æ¡†
        function openModal() {
            memberModal.style.display = 'block';
        }

        // å…³é—­æ¨¡æ€æ¡†
        function closeModal() {
            memberModal.style.display = 'none';
            memberForm.reset();
            currentMemberId = null;
            modalTitle.textContent = 'æ·»åŠ æˆå‘˜';
        }

        // æ·»åŠ æˆå‘˜
        function addMember() {
            modalTitle.textContent = 'æ·»åŠ æˆå‘˜';
            openModal();
        }

        // ç¼–è¾‘æˆå‘˜
        function editMember(id) {
            const member = members.find(m => m.id === id);
            if (member) {
                currentMemberId = id;
                modalTitle.textContent = 'ç¼–è¾‘æˆå‘˜';
                memberName.value = member.name;
                memberTitle.value = member.title;
                memberRole.value = member.role;
                memberDesc.value = member.desc;
                openModal();
            }
        }

        // æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†
        function showConfirmDialog(title, message, id, type, callback) {
            confirmTitle.textContent = title;
            confirmMessage.textContent = message;
            currentDeleteId = id;
            currentDeleteType = type;
            deleteCallback = callback;
            confirmModal.style.display = 'block';
        }

        // å…³é—­ç¡®è®¤å¯¹è¯æ¡†
        function closeConfirmDialog() {
            confirmModal.style.display = 'none';
            currentDeleteId = null;
            currentDeleteType = null;
            deleteCallback = null;
        }

        // æ‰§è¡Œåˆ é™¤æ“ä½œ
        function executeDelete() {
            if (deleteCallback && currentDeleteId !== null) {
                deleteCallback(currentDeleteId);
            }
            closeConfirmDialog();
        }

        // åˆ é™¤æˆå‘˜
        function deleteMember(id) {
            showConfirmDialog(
                'ç¡®è®¤åˆ é™¤',
                'ç¡®å®šè¦ä»ç³»ç»Ÿä¸­ç§»é™¤è¯¥æˆå‘˜å—ï¼Ÿç›¸å…³æ•°æ®å°†è¢«æ¸…é™¤',
                id,
                'member',
                function(deleteId) {
                    members = members.filter(m => m.id !== deleteId);
                    const saveResult = saveMembersToStorage();
                    if (saveResult.success) {
                        renderMembers();
                        showSuccessMessage('æˆå‘˜å·²æˆåŠŸåˆ é™¤');
                    } else {
                        showSuccessMessage(saveResult.message, false);
                    }
                }
            );
        }

        // ä¿å­˜æˆå‘˜
        memberForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const newMember = {
                name: memberName.value.trim(),
                title: memberTitle.value.trim(),
                role: memberRole.value.trim(),
                desc: memberDesc.value.trim()
            };
            
            // éªŒè¯æˆå‘˜æ•°æ®
            const validation = validateMemberData(newMember);
            if (!validation.valid) {
                showSuccessMessage(validation.message, false);
                return;
            }
            
            if (currentMemberId) {
                // ç¼–è¾‘ç°æœ‰æˆå‘˜
                const index = members.findIndex(m => m.id === currentMemberId);
                if (index !== -1) {
                    members[index] = { ...members[index], ...newMember };
                }
            } else {
                // æ·»åŠ æ–°æˆå‘˜
                newMember.id = nextId;
                members.push(newMember);
                nextId++;
            }
            
            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
            const saveResult = saveMembersToStorage();
            if (saveResult.success) {
                renderMembers();
                closeModal();
                showSuccessMessage(saveResult.message);
            } else {
                showSuccessMessage(saveResult.message, false);
            }
        });

        // ä»æœ¬åœ°å­˜å‚¨åŠ è½½æˆå‘˜
        function loadMembersFromStorage() {
            try {
                const savedMembers = localStorage.getItem('fasClubMembers');
                const savedNextId = localStorage.getItem('fasClubNextId');
                if (savedMembers) {
                    members = JSON.parse(savedMembers);
                    // éªŒè¯åŠ è½½çš„æ•°æ®æ ¼å¼
                    if (!Array.isArray(members)) {
                        throw new Error('æˆå‘˜æ•°æ®æ ¼å¼é”™è¯¯');
                    }
                }
                if (savedNextId) {
                    nextId = parseInt(savedNextId);
                    if (isNaN(nextId)) {
                        nextId = members.length + 1;
                    }
                } else {
                    nextId = members.length + 1;
                }
                renderMembers();
                return true;
            } catch (error) {
                console.error('åŠ è½½æˆå‘˜æ•°æ®å¤±è´¥:', error);
                // é‡ç½®ä¸ºé»˜è®¤æ•°æ®
                members = [];
                nextId = 1;
                renderMembers();
                return false;
            }
        }

        // éªŒè¯æˆå‘˜æ•°æ®
        function validateMemberData(member) {
            if (!member.name || member.name.trim() === '') {
                return { valid: false, message: 'æˆå‘˜åç§°ä¸èƒ½ä¸ºç©º' };
            }
            if (!member.title || member.title.trim() === '') {
                return { valid: false, message: 'æˆå‘˜ç§°å·ä¸èƒ½ä¸ºç©º' };
            }
            if (!member.role || member.role.trim() === '') {
                return { valid: false, message: 'æˆå‘˜èŒä½ä¸èƒ½ä¸ºç©º' };
            }
            if (!member.desc || member.desc.trim() === '') {
                return { valid: false, message: 'æˆå‘˜æè¿°ä¸èƒ½ä¸ºç©º' };
            }
            return { valid: true, message: '' };
        }

        // ä¿å­˜æˆå‘˜åˆ°æœ¬åœ°å­˜å‚¨
        function saveMembersToStorage() {
            try {
                // éªŒè¯æ‰€æœ‰æˆå‘˜æ•°æ®
                for (const member of members) {
                    const validation = validateMemberData(member);
                    if (!validation.valid) {
                        throw new Error(`æˆå‘˜æ•°æ®éªŒè¯å¤±è´¥: ${validation.message}`);
                    }
                }
                
                localStorage.setItem('fasClubMembers', JSON.stringify(members));
                localStorage.setItem('fasClubNextId', nextId.toString());
                return { success: true, message: 'æˆå‘˜æ•°æ®ä¿å­˜æˆåŠŸ' };
            } catch (error) {
                console.error('ä¿å­˜æˆå‘˜æ•°æ®å¤±è´¥:', error);
                return { success: false, message: `ä¿å­˜å¤±è´¥: ${error.message}` };
            }
        }

        // å…¬å‘Šæ•°æ®
        let announcements = [
            {
                id: 1,
                title: 'å…¬ä¼šæ‹›æ–°',
                content: 'æˆ‘ä»¬æ­£åœ¨å¯»æ‰¾çƒ­çˆ±Minecraft PVPçš„ç©å®¶åŠ å…¥æˆ‘ä»¬çš„å›¢é˜Ÿï¼æ— è®ºä½ æ˜¯æ–°æ‰‹è¿˜æ˜¯è€æ‰‹ï¼Œåªè¦ä½ æœ‰çƒ­æƒ…å’Œæ¯…åŠ›ï¼Œéƒ½æ¬¢è¿åŠ å…¥æˆ‘ä»¬ï¼',
                date: '2023-06-15'
            },
            {
                id: 2,
                title: 'PVPæ¯”èµ›é€šçŸ¥',
                content: 'æœ¬å‘¨å…­å°†ä¸¾è¡Œå…¬ä¼šå†…éƒ¨PVPæ¯”èµ›ï¼Œå¥–å“ä¸°åšï¼Œæ¬¢è¿å¤§å®¶ç§¯æå‚ä¸ï¼',
                date: '2023-06-10'
            },
            {
                id: 3,
                title: 'æœåŠ¡å™¨æ›´æ–°',
                content: 'æœåŠ¡å™¨å·²æ›´æ–°è‡³æœ€æ–°ç‰ˆæœ¬ï¼Œæ–°å¢äº†ä¸€äº›PVPç›¸å…³çš„æ’ä»¶å’Œåœ°å›¾ï¼Œæ¬¢è¿å¤§å®¶ä½“éªŒï¼',
                date: '2023-06-05'
            }
        ];

        let nextAnnouncementId = announcements.length + 1;

        // è·å–å…¬å‘Šç›¸å…³DOMå…ƒç´ 
        const announcementsList = document.getElementById('announcementsList');
        const addAnnouncementBtn = document.getElementById('addAnnouncementBtn');
        const announcementModal = document.getElementById('announcementModal');
        const closeAnnouncementModal = document.getElementById('closeAnnouncementModal');
        const announcementForm = document.getElementById('announcementForm');
        const announcementModalTitle = document.getElementById('announcementModalTitle');
        const announcementTitle = document.getElementById('announcementTitle');
        const announcementContent = document.getElementById('announcementContent');

        // å½“å‰ç¼–è¾‘çš„å…¬å‘ŠID
        let currentAnnouncementId = null;

        // ç¡®è®¤å¯¹è¯æ¡†ç›¸å…³DOMå…ƒç´ 
        const confirmModal = document.getElementById('confirmModal');
        const confirmTitle = document.getElementById('confirmTitle');
        const confirmMessage = document.getElementById('confirmMessage');
        const confirmCancelBtn = document.getElementById('confirmCancelBtn');
        const confirmDeleteBtn = document.getElementById('confirmDeleteBtn');
        
        // æˆåŠŸæç¤ºæ¨¡æ€æ¡†ç›¸å…³DOMå…ƒç´ 
        const successModal = document.getElementById('successModal');
        const successMessage = document.getElementById('successMessage');
        const successOkBtn = document.getElementById('successOkBtn');
        
        // å½“å‰å¾…åˆ é™¤çš„IDå’Œç±»å‹
        let currentDeleteId = null;
        let currentDeleteType = null;
        let deleteCallback = null;

        // æ¸²æŸ“å…¬å‘Šåˆ—è¡¨
        function renderAnnouncements() {
            announcementsList.innerHTML = '';
            
            // æŒ‰æ—¥æœŸé™åºæ’åºå…¬å‘Šï¼ˆæœ€æ–°çš„åœ¨å‰é¢ï¼‰
            const sortedAnnouncements = [...announcements].sort((a, b) => {
                return new Date(b.date) - new Date(a.date);
            });
            
            // åªæ˜¾ç¤ºæœ€æ–°çš„3æ¡å…¬å‘Š
            const recentAnnouncements = sortedAnnouncements.slice(0, 3);
            
            // å¦‚æœæ²¡æœ‰å…¬å‘Šï¼Œæ˜¾ç¤ºæç¤ºä¿¡æ¯
            if (recentAnnouncements.length === 0) {
                announcementsList.innerHTML = '<p style="text-align: center; color: #94a3b8; font-style: italic; margin: 2rem 0;">æš‚æ— å…¬å‘Š</p>';
                return;
            }
            
            recentAnnouncements.forEach(announcement => {
                const announcementItem = document.createElement('div');
                announcementItem.className = 'announcement-item';
                announcementItem.innerHTML = `
                    <div class="announcement-title">${announcement.title}</div>
                    <div class="announcement-date">${announcement.date}</div>
                    <div class="announcement-content">${announcement.content}</div>
                    <div style="margin-top: 1rem;">
                        <button class="member-action-btn admin-only" onclick="editAnnouncement(${announcement.id})">ç¼–è¾‘</button>
                        <button class="member-action-btn delete admin-only" onclick="deleteAnnouncement(${announcement.id})">åˆ é™¤</button>
                    </div>
                `;
                announcementsList.appendChild(announcementItem);
            });
            
            // æ·»åŠ "å¾€æœŸå…¬å‘Š"æŒ‰é’®ï¼Œæ— è®ºæœ‰å¤šå°‘æ¡å…¬å‘Šéƒ½æ˜¾ç¤º
            if (sortedAnnouncements.length > 0) {
                const viewMoreButton = document.createElement('button');
                viewMoreButton.className = 'view-more-announcements';
                viewMoreButton.textContent = 'å¾€æœŸå…¬å‘Š';
                viewMoreButton.onclick = () => {
                    window.location.href = 'announcements.html';
                };
                announcementsList.appendChild(viewMoreButton);
            }
        }

        // æ‰“å¼€å…¬å‘Šæ¨¡æ€æ¡†
        function openAnnouncementModal() {
            announcementModal.style.display = 'block';
        }

        // å…³é—­å…¬å‘Šæ¨¡æ€æ¡†
        function closeAnnouncementModalFunc() {
            announcementModal.style.display = 'none';
            announcementForm.reset();
            currentAnnouncementId = null;
            announcementModalTitle.textContent = 'å‘å¸ƒå…¬å‘Š';
        }

        // æ·»åŠ å…¬å‘Š
        function addAnnouncement() {
            announcementModalTitle.textContent = 'å‘å¸ƒå…¬å‘Š';
            openAnnouncementModal();
        }

        // ç¼–è¾‘å…¬å‘Š
        function editAnnouncement(id) {
            const announcement = announcements.find(a => a.id === id);
            if (announcement) {
                currentAnnouncementId = id;
                announcementModalTitle.textContent = 'ç¼–è¾‘å…¬å‘Š';
                announcementTitle.value = announcement.title;
                announcementContent.value = announcement.content;
                openAnnouncementModal();
            }
        }

        // åˆ é™¤å…¬å‘Š
        function deleteAnnouncement(id) {
            showConfirmDialog(
                'ç¡®è®¤åˆ é™¤',
                'ç¡®å®šè¦åˆ é™¤æ­¤å…¬å‘Šå—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€',
                id,
                'announcement',
                function(deleteId) {
                    announcements = announcements.filter(a => a.id !== deleteId);
                    const saveResult = saveAnnouncementsToStorage();
                    if (saveResult.success) {
                        renderAnnouncements();
                        showSuccessMessage('å…¬å‘Šå·²æˆåŠŸåˆ é™¤');
                    } else {
                        showSuccessMessage(saveResult.message, false);
                    }
                }
            );
        }

        // ä¿å­˜å…¬å‘Š
        announcementForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // åˆ›å»ºæ—¥æœŸå¯¹è±¡å¹¶æ ¼å¼åŒ–ä¸ºYYYY-MM-DDæ ¼å¼
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const dateStr = `${year}-${month}-${day}`;
            const newAnnouncement = {
                title: announcementTitle.value.trim(),
                content: announcementContent.value.trim(),
                date: dateStr
            };
            
            // éªŒè¯å…¬å‘Šæ•°æ®
            const validation = validateAnnouncementData(newAnnouncement);
            if (!validation.valid) {
                showSuccessMessage(validation.message, false);
                return;
            }
            
            if (currentAnnouncementId) {
                // ç¼–è¾‘ç°æœ‰å…¬å‘Š
                const index = announcements.findIndex(a => a.id === currentAnnouncementId);
                if (index !== -1) {
                    announcements[index] = { ...announcements[index], ...newAnnouncement };
                }
            } else {
                // æ·»åŠ æ–°å…¬å‘Š
                newAnnouncement.id = nextAnnouncementId;
                announcements.push(newAnnouncement);
                nextAnnouncementId++;
            }
            
            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
            const saveResult = saveAnnouncementsToStorage();
            if (saveResult.success) {
                renderAnnouncements();
                closeAnnouncementModalFunc();
                showSuccessMessage(saveResult.message);
            } else {
                showSuccessMessage(saveResult.message, false);
            }
        });

        // ä»æœ¬åœ°å­˜å‚¨åŠ è½½å…¬å‘Š
        function loadAnnouncementsFromStorage() {
            try {
                const savedAnnouncements = localStorage.getItem('fasClubAnnouncements');
                const savedNextId = localStorage.getItem('fasClubNextAnnouncementId');
                if (savedAnnouncements) {
                    announcements = JSON.parse(savedAnnouncements);
                    // éªŒè¯åŠ è½½çš„æ•°æ®æ ¼å¼
                    if (!Array.isArray(announcements)) {
                        throw new Error('å…¬å‘Šæ•°æ®æ ¼å¼é”™è¯¯');
                    }
                    
                    // éªŒè¯æ—¥æœŸæ ¼å¼ï¼Œä¿®å¤æ ¼å¼ä¸æ­£ç¡®çš„æ—¥æœŸ
                    announcements = announcements.map(announcement => {
                        // ç¡®ä¿å…¬å‘Šæœ‰ID
                        if (!announcement.id) {
                            announcement.id = Math.max(...announcements.map(a => a.id || 0)) + 1;
                        }
                        
                        // ä¿®å¤æ—¥æœŸæ ¼å¼
                        if (announcement.date && !/^\d{4}-\d{2}-\d{2}$/.test(announcement.date)) {
                            const date = new Date(announcement.date);
                            if (!isNaN(date.getTime())) {
                                const year = date.getFullYear();
                                const month = String(date.getMonth() + 1).padStart(2, '0');
                                const day = String(date.getDate()).padStart(2, '0');
                                announcement.date = `${year}-${month}-${day}`;
                            } else {
                                // å¦‚æœæ—¥æœŸæ— æ•ˆï¼Œä½¿ç”¨å½“å‰æ—¥æœŸ
                                const now = new Date();
                                const year = now.getFullYear();
                                const month = String(now.getMonth() + 1).padStart(2, '0');
                                const day = String(now.getDate()).padStart(2, '0');
                                announcement.date = `${year}-${month}-${day}`;
                            }
                        }
                        
                        return announcement;
                    });
                    
                    // ä¿å­˜ä¿®å¤åçš„æ•°æ®
                    localStorage.setItem('fasClubAnnouncements', JSON.stringify(announcements));
                }
                if (savedNextId) {
                    nextAnnouncementId = parseInt(savedNextId);
                    if (isNaN(nextAnnouncementId)) {
                        nextAnnouncementId = announcements.length + 1;
                    }
                } else {
                    nextAnnouncementId = announcements.length + 1;
                }
                renderAnnouncements();
                return true;
            } catch (error) {
                console.error('åŠ è½½å…¬å‘Šæ•°æ®å¤±è´¥:', error);
                // é‡ç½®ä¸ºé»˜è®¤æ•°æ®
                announcements = [];
                nextAnnouncementId = 1;
                renderAnnouncements();
                return false;
            }
        }

        // éªŒè¯å…¬å‘Šæ•°æ®
        function validateAnnouncementData(announcement) {
            if (!announcement.title || announcement.title.trim() === '') {
                return { valid: false, message: 'å…¬å‘Šæ ‡é¢˜ä¸èƒ½ä¸ºç©º' };
            }
            if (!announcement.content || announcement.content.trim() === '') {
                return { valid: false, message: 'å…¬å‘Šå†…å®¹ä¸èƒ½ä¸ºç©º' };
            }
            if (!announcement.date || !/^\d{4}-\d{2}-\d{2}$/.test(announcement.date)) {
                return { valid: false, message: 'å…¬å‘Šæ—¥æœŸæ ¼å¼ä¸æ­£ç¡®' };
            }
            return { valid: true, message: '' };
        }

        // ä¿å­˜å…¬å‘Šåˆ°æœ¬åœ°å­˜å‚¨
        function saveAnnouncementsToStorage() {
            try {
                // éªŒè¯æ‰€æœ‰å…¬å‘Šæ•°æ®
                for (const announcement of announcements) {
                    const validation = validateAnnouncementData(announcement);
                    if (!validation.valid) {
                        throw new Error(`å…¬å‘Šæ•°æ®éªŒè¯å¤±è´¥: ${validation.message}`);
                    }
                }
                
                localStorage.setItem('fasClubAnnouncements', JSON.stringify(announcements));
                localStorage.setItem('fasClubNextAnnouncementId', nextAnnouncementId.toString());
                return { success: true, message: 'å…¬å‘Šæ•°æ®ä¿å­˜æˆåŠŸ' };
            } catch (error) {
                console.error('ä¿å­˜å…¬å‘Šæ•°æ®å¤±è´¥:', error);
                return { success: false, message: `ä¿å­˜å¤±è´¥: ${error.message}` };
            }
        }

        // æ˜¾ç¤ºæˆåŠŸ/é”™è¯¯æç¤ºæ¶ˆæ¯
        function showSuccessMessage(message, isSuccess = true) {
            successMessage.textContent = message;
            // æ ¹æ®æ¶ˆæ¯ç±»å‹è°ƒæ•´æ ·å¼
            const modalContent = successModal.querySelector('.modal-content');
            if (isSuccess) {
                modalContent.style.borderColor = '#4CAF50';
                modalContent.style.backgroundColor = 'rgba(0, 0, 0, 0.9)';
            } else {
                modalContent.style.borderColor = '#f44336';
                modalContent.style.backgroundColor = 'rgba(0, 0, 0, 0.9)';
            }
            successModal.style.display = 'block';
        }

        // å…³é—­æˆåŠŸæç¤ºæ¨¡æ€æ¡†
        function closeSuccessModalFunc() {
            successModal.style.display = 'none';
        }

        // äº‹ä»¶ç›‘å¬å™¨
        addMemberBtn.addEventListener('click', addMember);
        closeMemberModal.addEventListener('click', closeModal);
        addAnnouncementBtn.addEventListener('click', addAnnouncement);
        closeAnnouncementModal.addEventListener('click', closeAnnouncementModalFunc);
        confirmCancelBtn.addEventListener('click', closeConfirmDialog);
        confirmDeleteBtn.addEventListener('click', executeDelete);
        // äº‹ä»¶ç›‘å¬å™¨ï¼šå…³é—­æˆåŠŸæç¤ºæ¨¡æ€æ¡†
        document.getElementById('closeSuccessModal').addEventListener('click', closeSuccessModalFunc);
        // äº‹ä»¶ç›‘å¬å™¨ï¼šç¡®è®¤æˆåŠŸæç¤º
        successOkBtn.addEventListener('click', closeSuccessModalFunc);

        // å¹³æ»‘æ»šåŠ¨åŠŸèƒ½
        // å·¦ä¸Šè§’logoç‚¹å‡»å¹³æ»‘æ»šåŠ¨åˆ°é¡¶éƒ¨
        document.querySelector('.fas-logo').addEventListener('click', function() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
        
        // å¯¼èˆªé“¾æ¥ç‚¹å‡»å¹³æ»‘æ»šåŠ¨
        document.querySelectorAll('nav ul li a').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    targetElement.scrollIntoView({
                        behavior: 'smooth'
                    });
                }
            });
        });

        // åˆ é™¤äº†ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­çš„åŠŸèƒ½ï¼Œç°åœ¨åªèƒ½é€šè¿‡ç‚¹å‡»å‰æŒ‰é’®å…³é—­æ¨¡æ€æ¡†

        // åˆå§‹åŒ–
        // ç®¡ç†å‘˜ç™»å½•çŠ¶æ€
        let isAdminLoggedIn = false;
        let currentAdminUser = '';
        
        // åˆå§‹åŒ–ç®¡ç†å‘˜è´¦å·
        initAdminAccounts();

        // ä¸ºå…¬ä¼šæˆå‘˜æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶
        document.getElementById('charactersBtn').addEventListener('click', function() {
            window.location.href = 'characters.html';
        });

        // æ˜¾ç¤º/éšè—ç®¡ç†åŠŸèƒ½
        function toggleAdminFeatures() {
            const adminButtons = document.querySelectorAll('.admin-only');
            adminButtons.forEach(button => {
                button.style.display = isAdminLoggedIn ? 'inline-block' : 'none';
            });
            
            // åˆ‡æ¢ç™»å½•/é€€å‡ºæŒ‰é’®æ–‡æœ¬
            const loginBtn = document.getElementById('adminLoginBtn');
            loginBtn.textContent = isAdminLoggedIn ? 'é€€å‡ºç™»å½•' : 'ç®¡ç†å‘˜ç™»å½•';
            
            // æ˜¾ç¤º/éšè—è´¦å·ç®¡ç†æŒ‰é’®
            const manageBtn = document.getElementById('adminManageBtn');
            manageBtn.style.display = isAdminLoggedIn ? 'inline-block' : 'none';
        }

        // æ‰“å¼€ç®¡ç†å‘˜ç™»å½•æ¨¡æ€æ¡†
        function openAdminLoginModal() {
            document.getElementById('adminLoginModal').style.display = 'block';
        }

        // å…³é—­ç®¡ç†å‘˜ç™»å½•æ¨¡æ€æ¡†
        function closeAdminLoginModal() {
            document.getElementById('adminLoginModal').style.display = 'none';
            // é‡ç½®è¡¨å•
            document.getElementById('adminLoginForm').reset();
        }

        // æ˜¾ç¤ºç™»å½•æ¶ˆæ¯æ¨¡æ€æ¡†
        function showLoginMessage(title, message, isSuccess) {
            document.getElementById('loginMessageTitle').textContent = title;
            const messageElement = document.getElementById('loginMessage');
            messageElement.textContent = message;
            messageElement.style.color = isSuccess ? '#4CAF50' : '#f44336';
            document.getElementById('loginMessageModal').style.display = 'block';
        }

        // å…³é—­ç™»å½•æ¶ˆæ¯æ¨¡æ€æ¡†
        function closeLoginMessageModal() {
            document.getElementById('loginMessageModal').style.display = 'none';
        }

        // åˆå§‹åŒ–ç®¡ç†å‘˜è´¦å·å­˜å‚¨ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
        function initAdminAccounts() {
            const accounts = JSON.parse(localStorage.getItem('adminAccounts'));
            if (!accounts) {
                // åˆ›å»ºé»˜è®¤ç®¡ç†å‘˜è´¦å·
                const defaultAccounts = [
                    { username: 'admin', password: 'admin123456', createdAt: new Date().toISOString() }
                ];
                localStorage.setItem('adminAccounts', JSON.stringify(defaultAccounts));
            }
        }

        // è·å–æ‰€æœ‰ç®¡ç†å‘˜è´¦å·
        function getAdminAccounts() {
            return JSON.parse(localStorage.getItem('adminAccounts')) || [];
        }

        // æ·»åŠ ç®¡ç†å‘˜è´¦å·
        function addAdminAccount(username, password) {
            const accounts = getAdminAccounts();
            // æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨
            if (accounts.find(account => account.username === username)) {
                return false;
            }
            // æ·»åŠ æ–°è´¦å·
            accounts.push({
                username,
                password,
                createdAt: new Date().toISOString()
            });
            localStorage.setItem('adminAccounts', JSON.stringify(accounts));
            return true;
        }

        // éªŒè¯ç®¡ç†å‘˜è´¦å·
        function validateAdminAccount(username, password) {
            const accounts = getAdminAccounts();
            return accounts.find(account => account.username === username && account.password === password);
        }

        // ç”ŸæˆéšæœºToken
        function generateToken() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let token = '';
            for (let i = 0; i < 32; i++) {
                token += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return token;
        }

        // ç®¡ç†å‘˜ç™»å½•å¤„ç†
        function handleAdminLogin(event) {
            event.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            // éªŒè¯è´¦å·å¯†ç 
            const account = validateAdminAccount(username, password);
            if (account) {
                // ç”Ÿæˆç™»å½•å‡­è¯
                const token = generateToken();
                const expiresAt = new Date(Date.now() + 24 * 60 * 60 * 1000); // 24å°æ—¶è¿‡æœŸ
                
                // å­˜å‚¨ç™»å½•çŠ¶æ€
                localStorage.setItem('adminToken', token);
                localStorage.setItem('adminTokenExpires', expiresAt.toISOString());
                localStorage.setItem('currentAdminUser', JSON.stringify(account));
                
                isAdminLoggedIn = true;
                currentAdminUser = account;
                
                toggleAdminFeatures();
                closeAdminLoginModal();
                showLoginMessage('ç™»å½•æˆåŠŸ', `ç®¡ç†å‘˜ ${username} ç™»å½•æˆåŠŸï¼`, true);
                
                // è®°å½•ç™»å½•æ—¥å¿—
                logAdminAction('login', `ç®¡ç†å‘˜ ${username} ç™»å½•æˆåŠŸ`);
            } else {
                showLoginMessage('ç™»å½•å¤±è´¥', 'è´¦å·æˆ–å¯†ç é”™è¯¯ï¼', false);
                
                // è®°å½•å¤±è´¥æ—¥å¿—
                logAdminAction('login_failed', `ç®¡ç†å‘˜ç™»å½•å¤±è´¥ï¼Œç”¨æˆ·åï¼š${username}`);
            }
        }

        // ç®¡ç†å‘˜é€€å‡ºç™»å½•å¤„ç†
        function handleAdminLogout() {
            // è®°å½•é€€å‡ºæ—¥å¿—
            logAdminAction('logout', `ç®¡ç†å‘˜ ${currentAdminUser.username} é€€å‡ºç™»å½•`);
            
            // æ¸…é™¤ç™»å½•çŠ¶æ€
            localStorage.removeItem('adminToken');
            localStorage.removeItem('adminTokenExpires');
            localStorage.removeItem('currentAdminUser');
            
            isAdminLoggedIn = false;
            currentAdminUser = '';
            
            toggleAdminFeatures();
        }

        // æ£€æŸ¥å¹¶æ¢å¤ç™»å½•çŠ¶æ€
        function checkLoginStatus() {
            const token = localStorage.getItem('adminToken');
            const expiresAt = localStorage.getItem('adminTokenExpires');
            const userData = localStorage.getItem('currentAdminUser');
            
            if (token && expiresAt && userData) {
                const now = new Date();
                const expiryDate = new Date(expiresAt);
                
                if (now < expiryDate) {
                    // å‡­è¯æœ‰æ•ˆ
                    isAdminLoggedIn = true;
                    currentAdminUser = JSON.parse(userData);
                    toggleAdminFeatures();
                    
                    // è®°å½•æ—¥å¿—
                    logAdminAction('session_restored', `ç®¡ç†å‘˜ ${currentAdminUser.username} ä¼šè¯æ¢å¤`);
                    return true;
                } else {
                    // å‡­è¯è¿‡æœŸ
                    handleAdminLogout();
                    
                    // è®°å½•æ—¥å¿—
                    logAdminAction('session_expired', `ç®¡ç†å‘˜ä¼šè¯è¿‡æœŸï¼Œç”¨æˆ·ï¼š${JSON.parse(userData).username}`);
                    return false;
                }
            }
            return false;
        }
        
        // è®°å½•ç®¡ç†å‘˜æ“ä½œæ—¥å¿—
        function logAdminAction(action, description) {
            // è·å–ç°æœ‰æ—¥å¿—
            const logs = JSON.parse(localStorage.getItem('adminLogs')) || [];
            
            // æ·»åŠ æ–°æ—¥å¿—
            logs.push({
                action,
                description,
                timestamp: new Date().toISOString(),
                user: currentAdminUser ? currentAdminUser.username : 'unknown'
            });
            
            // åªä¿ç•™æœ€è¿‘100æ¡æ—¥å¿—
            if (logs.length > 100) {
                logs.shift();
            }
            
            // ä¿å­˜æ—¥å¿—
            localStorage.setItem('adminLogs', JSON.stringify(logs));
        }

        document.addEventListener('DOMContentLoaded', function() {
            loadMembersFromStorage();
            loadAnnouncementsFromStorage();
            
            // åˆå§‹åŒ–ç®¡ç†å‘˜è´¦å·
            initAdminAccounts();
            
            // æ£€æŸ¥å¹¶æ¢å¤ç™»å½•çŠ¶æ€
            checkLoginStatus();

            // ä¸ºç®¡ç†å‘˜ç™»å½•/é€€å‡ºæŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
            const loginBtn = document.getElementById('adminLoginBtn');
            loginBtn.addEventListener('click', function() {
                if (isAdminLoggedIn) {
                    // é€€å‡ºç™»å½•
                    handleAdminLogout();
                    showLoginMessage('é€€å‡ºæˆåŠŸ', 'æ‚¨å·²æˆåŠŸé€€å‡ºç®¡ç†å‘˜ç™»å½•ï¼', true);
                } else {
                    // æ‰“å¼€ç™»å½•æ¨¡æ€æ¡†
                    openAdminLoginModal();
                }
            });
            
            // ä¸ºè´¦å·ç®¡ç†æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
            const manageBtn = document.getElementById('adminManageBtn');
            manageBtn.addEventListener('click', function() {
                if (isAdminLoggedIn) {
                    window.location.href = 'admin_management.html';
                }
            });
            // ä¸ºç®¡ç†å‘˜ç™»å½•è¡¨å•æ·»åŠ æäº¤äº‹ä»¶ç›‘å¬å™¨
            document.getElementById('adminLoginForm').addEventListener('submit', handleAdminLogin);
            // ä¸ºç™»å½•æ¨¡æ€æ¡†å…³é—­æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
            document.querySelector('#adminLoginModal .close').addEventListener('click', closeAdminLoginModal);
            
            // ä¸ºå¯†ç æ˜¾ç¤º/éšè—æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
            const togglePasswordBtn = document.getElementById('togglePassword');
            const passwordInput = document.getElementById('password');
            togglePasswordBtn.addEventListener('click', function() {
                const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                passwordInput.setAttribute('type', type);
                this.textContent = type === 'password' ? 'ğŸ‘ï¸' : 'ğŸ™ˆ';
            });
            // ä¸ºç™»å½•æ¶ˆæ¯æ¨¡æ€æ¡†å…³é—­æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
            document.getElementById('closeLoginMessageModal').addEventListener('click', closeLoginMessageModal);
        });

        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­æ¨¡æ€æ¡† (ä»…å¯¹ç™»å½•æ¶ˆæ¯æ¨¡æ€æ¡†ç”Ÿæ•ˆ)
        window.onclick = function(event) {
            const loginMessageModal = document.getElementById('loginMessageModal');
            if (event.target === loginMessageModal) {
                closeLoginMessageModal();
            }
        }
    </script>
</body>
</html>